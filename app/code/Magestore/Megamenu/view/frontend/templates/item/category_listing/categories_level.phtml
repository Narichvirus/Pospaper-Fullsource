<?php

/**
 * Magestore
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Magestore.com license that is
 * available through the world-wide-web at this URL:
 * http://www.magestore.com/license-agreement.html
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade this extension to newer
 * version in the future.
 *
 * @category    Magestore
 * @package     Magestore_Megamenu
 * @copyright   Copyright (c) 2012 Magestore (http://www.magestore.com/)
 * @license     http://www.magestore.com/license-agreement.html
 */
?>
<?php
$categories = $block->getParentCategories();
?>
<?php if ($categories->getSize()): ?>
    <div class="row ms-category-level">
        <div class="col-category col-xs-12">
            <?php /*
            <div class="row">
                <?php $i=0;foreach($categories as $category): ?>
                    <?php $childrens = $block->getChildrenCategoriesByLevel($category,2);?>
                    <?php
                    if($i == 0 || $i % 9 == 0)
                    {
                    ?>
                    <ul>
                    <?php
                    }
                    ?>
                    <li>
                    <div class="col-xs-12 col-level <?php if(count($childrens) >0) echo 'parent' ?>">
                        <a class="form-group " href="<?php echo $category->getUrl() ?>"><small class="glyphicon glyphicon-th-large">&nbsp;</small><?php echo $category->getName()." ".$i ?><?php if(count($childrens) >0) :?><small class="glyphicon glyphicon-chevron-right small">&nbsp;</small><?php endif;?></a>
                        <?php if(count($childrens) >0) :?>
                            <div class="col-xs-12 col-sub">
                                <div class="row">
                                    <?php foreach($childrens as $children):?>
                                        <?php $childs =  $block->getChildrenCategoriesByLevel($children,3) ?>
                                        <div class="col-xs-12<?php if(count($childs) >0):?> parent<?php endif;?>">
                                            <a class="form-group" href="<?php echo $children->getUrl() ?>"><small class="glyphicon glyphicon-th-large">&nbsp;</small><?php echo $children->getName() ?><?php if(count($childs) >0):?><small class="glyphicon glyphicon-chevron-right small">&nbsp;</small><?php endif;?></a>
                                            <?php if($children->hasChildren() && count($childs)>0): ?>
                                                <div class="col-xs-12 col-sub">
                                                    <?php foreach($childs as $child): ?>
                                                        <a class="form-group" href="<?php echo $child->getUrl() ?>"><small class="glyphicon glyphicon-th-large">&nbsp;</small><?php echo $child->getName() ?></a>
                                                    <?php  endforeach;?>
                                                </div>
                                            <?php  endif;?>
                                        </div>
                                    <?php endforeach;?>
                                </div>
                            </div>
                        <?php endif; ?>
                        </div>
                    </li>
                <?php 
                $i++;
                if($i % 9 == 0)
                {
                    echo "</ul>";   
                }
                endforeach;?>
            </div> */ ?>

            <?php
            	$n = $categories->getSize();
            	
            	if(fmod($n,4) == 0){
				    $col1 = ceil($n/4);
				    $col2 = ceil($n/4);
				    $col3 = ceil($n/4);
				    $col4 = ceil($n/4);
				}
				if(fmod($n,4) == 1){
				    $col1 = ceil($n/4);
				    $col2 = floor($n/4);
				    $col3 = floor($n/4);
				    $col4 = floor($n/4);
				    
				}
				if(fmod($n,4) == 2){
				    $col1 = ceil($n/4);
				    $col2 = ceil($n/4);
				    $col3 = floor($n/4);
				    $col4 = floor($n/4);
				    
				}
				if(fmod($n,4) == 3){
				    $col1 = ceil($n/4);
				    $col2 = ceil($n/4);
				    $col3 = ceil($n/4);
				    $col4 = floor($n/4);
				    
				}
            	?>

            	<div class="row">
            		<ul>
                <?php $i=1;foreach($categories as $category): ?>
                    <?php $childrens = $block->getChildrenCategoriesByLevel($category,2);?>
                    <?php
                    if($i > 0 && $i <= $col1){
                    ?>
                    <li>
                    <div class="col-xs-12 col-level <?php if(count($childrens) >0) echo 'parent' ?>">
                        <?php
                        if(count($childrens) >0)
                        {
                        ?>
                        <a class="form-group"><?php echo $category->getName() ?></a>
                        <?php
                        }
                        else
                        {
                            ?>
                            <a class="form-group" href="<?php echo $category->getUrl() ?>"><?php echo $category->getName() ?></a>
                            <?php
                        }
                        ?>
                        <?php if(count($childrens) >0) :?>
                            <div class="col-xs-12 col-sub">
                                <div class="row">
                                    <?php foreach($childrens as $children):?>
                                        <?php $childs =  $block->getChildrenCategoriesByLevel($children,3) ?>
                                        <div class="col-xs-12<?php if(count($childs) >0):?> parent<?php endif;?>">
                                            <a class="form-group" href="<?php echo $children->getUrl() ?>"><small class="glyphicon glyphicon-th-large">&nbsp;</small><?php echo $children->getName() ?><?php if(count($childs) >0):?><small class="glyphicon glyphicon-chevron-right small">&nbsp;</small><?php endif;?></a>
                                            <?php if($children->hasChildren() && count($childs)>0): ?>
                                                <div class="col-xs-12 col-sub">
                                                    <?php foreach($childs as $child): ?>
                                                        <a class="form-group" href="<?php echo $child->getUrl() ?>"><small class="glyphicon glyphicon-th-large">&nbsp;</small><?php echo $child->getName() ?></a>
                                                    <?php  endforeach;?>
                                                </div>
                                            <?php  endif;?>
                                        </div>
                                    <?php endforeach;?>
                                </div>
                            </div>
                        <?php endif; ?>
                        </div>
                    </li>
                    <?php
                	}else if($i > $col1 && $i <= ($col2 * 2)){
                		if($i == ($col1 + 1)){
            				echo "</ul><ul>";
        				}
                    ?>
                    <li>
                    <div class="col-xs-12 col-level <?php if(count($childrens) >0) echo 'parent' ?>">
                        <?php
                        if(count($childrens) >0)
                        {
                        ?>
                        <a class="form-group"><?php echo $category->getName() ?></a>
                        <?php
                        }
                        else
                        {
                            ?>
                            <a class="form-group" href="<?php echo $category->getUrl() ?>"><?php echo $category->getName() ?></a>
                            <?php
                        }
                        ?>
                        <?php if(count($childrens) >0) :?>
                            <div class="col-xs-12 col-sub">
                                <div class="row">
                                    <?php foreach($childrens as $children):?>
                                        <?php $childs =  $block->getChildrenCategoriesByLevel($children,3) ?>
                                        <div class="col-xs-12<?php if(count($childs) >0):?> parent<?php endif;?>">
                                            <a class="form-group" href="<?php echo $children->getUrl() ?>"><small class="glyphicon glyphicon-th-large">&nbsp;</small><?php echo $children->getName() ?><?php if(count($childs) >0):?><small class="glyphicon glyphicon-chevron-right small">&nbsp;</small><?php endif;?></a>
                                            <?php if($children->hasChildren() && count($childs)>0): ?>
                                                <div class="col-xs-12 col-sub">
                                                    <?php foreach($childs as $child): ?>
                                                        <a class="form-group" href="<?php echo $child->getUrl() ?>"><small class="glyphicon glyphicon-th-large">&nbsp;</small><?php echo $child->getName() ?></a>
                                                    <?php  endforeach;?>
                                                </div>
                                            <?php  endif;?>
                                        </div>
                                    <?php endforeach;?>
                                </div>
                            </div>
                        <?php endif; ?>
                        </div>
                    </li>
                    <?php
                	}else if($i > ($col2 * 2) && $i <= ($col3 * 3)){
                		if($i == ($col1 + $col2) + 1){
				            echo "</ul><ul>";
				        }
                    ?>
                    <li>
                    <div class="col-xs-12 col-level <?php if(count($childrens) >0) echo 'parent' ?>">
                        <?php
                        if(count($childrens) >0)
                        {
                        ?>
                        <a class="form-group"><?php echo $category->getName() ?></a>
                        <?php
                        }
                        else
                        {
                            ?>
                            <a class="form-group" href="<?php echo $category->getUrl() ?>"><?php echo $category->getName() ?></a>
                            <?php
                        }
                        ?>
                        <?php if(count($childrens) >0) :?>
                            <div class="col-xs-12 col-sub">
                                <div class="row">
                                    <?php foreach($childrens as $children):?>
                                        <?php $childs =  $block->getChildrenCategoriesByLevel($children,3) ?>
                                        <div class="col-xs-12<?php if(count($childs) >0):?> parent<?php endif;?>">
                                            <a class="form-group" href="<?php echo $children->getUrl() ?>"><small class="glyphicon glyphicon-th-large">&nbsp;</small><?php echo $children->getName() ?><?php if(count($childs) >0):?><small class="glyphicon glyphicon-chevron-right small">&nbsp;</small><?php endif;?></a>
                                            <?php if($children->hasChildren() && count($childs)>0): ?>
                                                <div class="col-xs-12 col-sub">
                                                    <?php foreach($childs as $child): ?>
                                                        <a class="form-group" href="<?php echo $child->getUrl() ?>"><small class="glyphicon glyphicon-th-large">&nbsp;</small><?php echo $child->getName() ?></a>
                                                    <?php  endforeach;?>
                                                </div>
                                            <?php  endif;?>
                                        </div>
                                    <?php endforeach;?>
                                </div>
                            </div>
                        <?php endif; ?>
                        </div>
                    </li>
                    <?php
                	}else if($i > ($col3 * 3)){
                		if($i == ($col1 + $col2 + $col3) + 1){
				            echo "</ul><ul>";
				        }
                    ?>
                    <li>
                    <div class="col-xs-12 col-level <?php if(count($childrens) >0) echo 'parent' ?>">
                        <?php
                        if(count($childrens) >0)
                        {
                        ?>
                        <a class="form-group"><?php echo $category->getName() ?></a>
                        <?php
                        }
                        else
                        {
                            ?>
                            <a class="form-group" href="<?php echo $category->getUrl() ?>"><?php echo $category->getName() ?></a>
                            <?php
                        }
                        ?>
                        <?php if(count($childrens) >0) :?>
                            <div class="col-xs-12 col-sub">
                                <div class="row">
                                    <?php foreach($childrens as $children):?>
                                        <?php $childs =  $block->getChildrenCategoriesByLevel($children,3) ?>
                                        <div class="col-xs-12<?php if(count($childs) >0):?> parent<?php endif;?>">
                                            <a class="form-group" href="<?php echo $children->getUrl() ?>"><small class="glyphicon glyphicon-th-large">&nbsp;</small><?php echo $children->getName() ?><?php if(count($childs) >0):?><small class="glyphicon glyphicon-chevron-right small">&nbsp;</small><?php endif;?></a>
                                            <?php if($children->hasChildren() && count($childs)>0): ?>
                                                <div class="col-xs-12 col-sub">
                                                    <?php foreach($childs as $child): ?>
                                                        <a class="form-group" href="<?php echo $child->getUrl() ?>"><small class="glyphicon glyphicon-th-large">&nbsp;</small><?php echo $child->getName() ?></a>
                                                    <?php  endforeach;?>
                                                </div>
                                            <?php  endif;?>
                                        </div>
                                    <?php endforeach;?>
                                </div>
                            </div>
                        <?php endif; ?>
                        </div>
                    </li>
                    <?php
                	}
                ?>
                <?php 
                $i++;
                endforeach;?>
            </ul>
            </div>

        </div>
    </div>
<?php endif; ?>